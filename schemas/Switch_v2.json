{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Switch",
  "description": "Route items depending on defined expression or rules",
  "x-n8n-node-type": "switch",
  "x-n8n-version": 2,
  "x-n8n-group": [
    "transform"
  ],
  "type": "object",
  "properties": {
    "mode": {
      "x-title": "Mode",
      "description": "How data should be routed",
      "default": "rules",
      "type": "string",
      "enum": [
        "expression",
        "rules"
      ],
      "x-enumNames": [
        "Expression",
        "Rules"
      ],
      "x-enumDescriptions": [
        "Expression decides how to route data",
        "Rules decide how to route data"
      ]
    },
    "output": {
      "x-title": "Output",
      "description": "The index of output to which to send data to",
      "default": "",
      "x-displayOptions": {
        "show": {
          "mode": [
            "expression"
          ]
        }
      },
      "type": "string"
    },
    "outputsAmount": {
      "x-title": "Outputs Amount",
      "description": "Amount of outputs to create",
      "default": 4,
      "x-displayOptions": {
        "show": {
          "mode": [
            "expression"
          ]
        }
      },
      "type": "number"
    },
    "dataType": {
      "x-title": "Data Type",
      "description": "The type of data to route on",
      "default": "number",
      "x-displayOptions": {
        "show": {
          "mode": [
            "rules"
          ]
        }
      },
      "type": "string",
      "enum": [
        "boolean",
        "dateTime",
        "number",
        "string"
      ],
      "x-enumNames": [
        "Boolean",
        "Date & Time",
        "Number",
        "String"
      ]
    },
    "value1": {
      "x-title": "Value 1",
      "description": "The value to compare with the second one",
      "default": "",
      "x-displayOptions": {
        "show": {
          "dataType": [
            "string"
          ],
          "mode": [
            "rules"
          ]
        }
      },
      "type": "string"
    },
    "rules": {
      "x-title": "Routing Rules",
      "default": {},
      "x-displayOptions": {
        "show": {
          "dataType": [
            "string"
          ],
          "mode": [
            "rules"
          ]
        }
      },
      "type": "object",
      "properties": {
        "rules": {
          "x-title": "Strings",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "operation": {
                "x-title": "Operation",
                "description": "Operation to decide where the data should be mapped to",
                "default": "equal",
                "type": "string",
                "enum": [
                  "contains",
                  "notContains",
                  "endsWith",
                  "notEndsWith",
                  "equal",
                  "notEqual",
                  "regex",
                  "notRegex",
                  "startsWith",
                  "notStartsWith"
                ],
                "x-enumNames": [
                  "Contains",
                  "Not Contains",
                  "Ends With",
                  "Not Ends With",
                  "Equal",
                  "Not Equal",
                  "Regex Match",
                  "Regex Not Match",
                  "Starts With",
                  "Not Starts With"
                ]
              },
              "value2": {
                "x-title": "Regex",
                "description": "The regex which has to match",
                "default": "",
                "x-displayOptions": {
                  "show": {
                    "operation": [
                      "regex",
                      "notRegex"
                    ]
                  }
                },
                "type": "string"
              },
              "outputKey": {
                "x-title": "Output Key",
                "description": "The label of output to which to send data to if rule matches",
                "default": "",
                "type": "string"
              }
            }
          }
        }
      }
    },
    "fallbackOutput": {
      "x-title": "Fallback Output Name or ID",
      "description": "The output to which to route all items which do not match any of the rules. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>.",
      "default": -1,
      "x-displayOptions": {
        "show": {
          "mode": [
            "rules"
          ]
        }
      },
      "type": "string"
    }
  },
  "x-icon": "fa:map-signs",
  "x-inputs": [
    "main"
  ],
  "x-outputs": "={{\n\t\t\t\t\t((parameters) => {\n\t\t\t\t\t\tconst rules = parameters.rules?.rules ?? [];\n\t\t\t\t\t\tconst mode = parameters.mode;\n\n\t\t\t\t\t\tif (mode === 'expression') {\n\t\t\t\t\t\t\treturn Array\n\t\t\t\t\t\t\t\t.from(\n\t\t\t\t\t\t\t\t\t{ length: parameters.outputsAmount },\n\t\t\t\t\t\t\t\t\t(_, i) => ({ type: \"main\", displayName: i.toString() })\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\treturn rules.map(value => {\n\t\t\t\t\t\t\treturn { type: \"main\", displayName: value.outputKey }\n\t\t\t\t\t\t})\n\t\t\t\t\t})($parameter)\n\t\t\t\t}}"
}
