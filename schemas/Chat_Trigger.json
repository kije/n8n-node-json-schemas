{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Chat Trigger",
  "description": "Runs the workflow when an n8n generated webchat is submitted",
  "x-n8n-node-type": "chatTrigger",
  "x-n8n-version": [
    1,
    1.1,
    1.2,
    1.3,
    1.4
  ],
  "x-n8n-group": [
    "trigger"
  ],
  "type": "object",
  "properties": {
    "public": {
      "x-title": "Make Chat Publicly Available",
      "description": "Whether the chat should be publicly available or only accessible through the manual chat interface",
      "default": false,
      "type": "boolean"
    },
    "mode": {
      "x-title": "Mode",
      "default": "hostedChat",
      "x-displayOptions": {
        "show": {
          "public": [
            true
          ]
        }
      },
      "type": "string",
      "enum": [
        "hostedChat",
        "webhook"
      ],
      "x-enumNames": [
        "Hosted Chat",
        "Embedded Chat"
      ],
      "x-enumDescriptions": [
        "Chat on a page served by n8n",
        "Chat through a widget embedded in another page, or by calling a webhook"
      ]
    },
    "authentication": {
      "x-title": "Authentication",
      "description": "The way to authenticate",
      "default": "none",
      "x-displayOptions": {
        "show": {
          "public": [
            true
          ]
        }
      },
      "type": "string",
      "enum": [
        "basicAuth",
        "n8nUserAuth",
        "none"
      ],
      "x-enumNames": [
        "Basic Auth",
        "n8n User Auth",
        "None"
      ],
      "x-enumDescriptions": [
        "Simple username and password (the same one for all users)",
        "Require user to be logged in with their n8n account",
        ""
      ]
    },
    "initialMessages": {
      "x-title": "Initial Message(s)",
      "description": "Default messages shown at the start of the chat, one per line",
      "default": "Hi there! ðŸ‘‹\nMy name is Nathan. How can I assist you today?",
      "x-displayOptions": {
        "show": {
          "mode": [
            "hostedChat"
          ],
          "public": [
            true
          ]
        }
      },
      "type": "string",
      "x-rows": 3
    },
    "availableInChat": {
      "x-title": "Make Available in n8n Chat Hub",
      "description": "Whether to make the agent available in n8n Chat Hub for n8n instance users to chat with",
      "default": false,
      "type": "boolean"
    },
    "agentIcon": {
      "x-title": "Agent Icon",
      "description": "The icon of the agent on n8n Chat",
      "default": {
        "type": "icon",
        "value": "bot"
      },
      "x-displayOptions": {
        "show": {
          "availableInChat": [
            true
          ],
          "@version": [
            {
              "_cnd": {
                "gte": 1.2
              }
            }
          ]
        }
      },
      "type": "string",
      "x-n8n-type": "icon"
    },
    "agentName": {
      "x-title": "Agent Name",
      "description": "The name of the agent on n8n Chat. Name of the workflow is used if left empty.",
      "default": "",
      "x-displayOptions": {
        "show": {
          "availableInChat": [
            true
          ],
          "@version": [
            {
              "_cnd": {
                "gte": 1.2
              }
            }
          ]
        }
      },
      "type": "string"
    },
    "agentDescription": {
      "x-title": "Agent Description",
      "description": "The description of the agent on n8n Chat",
      "default": "",
      "x-displayOptions": {
        "show": {
          "availableInChat": [
            true
          ],
          "@version": [
            {
              "_cnd": {
                "gte": 1.2
              }
            }
          ]
        }
      },
      "type": "string",
      "x-rows": 2
    },
    "options": {
      "x-title": "Options",
      "default": {},
      "x-displayOptions": {
        "show": {
          "mode": [
            "hostedChat",
            "webhook"
          ],
          "public": [
            true
          ],
          "@version": [
            {
              "_cnd": {
                "gte": 1.3
              }
            }
          ]
        }
      },
      "type": "object",
      "properties": {
        "allowedOrigins": {
          "x-title": "Allowed Origins (CORS)",
          "description": "Comma-separated list of URLs allowed for cross-origin non-preflight requests. Use * (default) to allow all origins.",
          "default": "*",
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat",
                "webhook"
              ]
            }
          },
          "type": "string"
        },
        "allowFileUploads": {
          "x-title": "Allow File Uploads",
          "description": "Whether to allow file uploads in the chat",
          "default": false,
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat"
              ]
            }
          },
          "type": "boolean"
        },
        "allowedFilesMimeTypes": {
          "x-title": "Allowed File Mime Types",
          "description": "Allowed file types for upload. Comma-separated list of <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types\" target=\"_blank\">MIME types</a>.",
          "default": "*",
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat"
              ]
            }
          },
          "type": "string"
        },
        "inputPlaceholder": {
          "x-title": "Input Placeholder",
          "description": "Shown as placeholder text in the chat input field",
          "default": "Type your question..",
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat"
              ]
            }
          },
          "type": "string"
        },
        "loadPreviousSession": {
          "x-title": "Load Previous Session",
          "description": "If loading messages of a previous session should be enabled",
          "default": "notSupported",
          "type": "string",
          "enum": [
            "notSupported",
            "memory",
            "manually"
          ],
          "x-enumNames": [
            "Off",
            "From Memory",
            "Manually"
          ],
          "x-enumDescriptions": [
            "Loading messages of previous session is turned off",
            "Load session messages from memory",
            "Manually return messages of session"
          ]
        },
        "showWelcomeScreen": {
          "x-title": "Require Button Click to Start Chat",
          "description": "Whether to show the welcome screen at the start of the chat",
          "default": false,
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat"
              ]
            }
          },
          "type": "boolean"
        },
        "getStarted": {
          "x-title": "Start Conversation Button Text",
          "description": "Shown as part of the welcome screen, in the middle of the chat window",
          "default": "New Conversation",
          "x-displayOptions": {
            "show": {
              "showWelcomeScreen": [
                true
              ],
              "/mode": [
                "hostedChat"
              ]
            }
          },
          "type": "string"
        },
        "subtitle": {
          "x-title": "Subtitle",
          "description": "Shown at the top of the chat, under the title",
          "default": "Start a chat. We're here to help you 24/7.",
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat"
              ]
            }
          },
          "type": "string"
        },
        "title": {
          "x-title": "Title",
          "description": "Shown at the top of the chat",
          "default": "Hi there! ðŸ‘‹",
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat"
              ]
            }
          },
          "type": "string"
        },
        "customCss": {
          "x-title": "Custom Chat Styling",
          "description": "Override default styling of the public chat interface with CSS",
          "default": ":root {\n  /* Colors */\n  --chat--color--primary: #e74266;\n  --chat--color--primary-shade-50: #db4061;\n  --chat--color--primary--shade-100: #cf3c5c;\n  --chat--color--secondary: #20b69e;\n  --chat--color-secondary-shade-50: #1ca08a;\n  --chat--color-white: #fff;\n  --chat--color-light: #f2f4f8;\n  --chat--color-light-shade-50: #e6e9f1;\n  --chat--color-light-shade-100: #c2c5cc;\n  --chat--color-medium: #d2d4d9;\n  --chat--color-dark: #101330;\n  --chat--color-disabled: #d2d4d9;\n  --chat--color-typing: #404040;\n\n  /* Base Layout */\n  --chat--spacing: 1rem;\n  --chat--border-radius: 0.25rem;\n  --chat--transition-duration: 0.15s;\n  --chat--font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;\n\n  /* Window Dimensions */\n  --chat--window--width: 400px;\n  --chat--window--height: 600px;\n  --chat--window--bottom: var(--chat--spacing);\n  --chat--window--right: var(--chat--spacing);\n  --chat--window--z-index: 9999;\n  --chat--window--border: 1px solid var(--chat--color-light-shade-50);\n  --chat--window--border-radius: var(--chat--border-radius);\n  --chat--window--margin-bottom: var(--chat--spacing);\n\n  /* Header Styles */\n  --chat--header-height: auto;\n  --chat--header--padding: var(--chat--spacing);\n  --chat--header--background: var(--chat--color-dark);\n  --chat--header--color: var(--chat--color-light);\n  --chat--header--border-top: none;\n  --chat--header--border-bottom: none;\n  --chat--header--border-left: none;\n  --chat--header--border-right: none;\n  --chat--heading--font-size: 2em;\n  --chat--subtitle--font-size: inherit;\n  --chat--subtitle--line-height: 1.8;\n\n  /* Message Styles */\n  --chat--message--font-size: 1rem;\n  --chat--message--padding: var(--chat--spacing);\n  --chat--message--border-radius: var(--chat--border-radius);\n  --chat--message-line-height: 1.5;\n  --chat--message--margin-bottom: calc(var(--chat--spacing) * 1);\n  --chat--message--bot--background: var(--chat--color-white);\n  --chat--message--bot--color: var(--chat--color-dark);\n  --chat--message--bot--border: none;\n  --chat--message--user--background: var(--chat--color--secondary);\n  --chat--message--user--color: var(--chat--color-white);\n  --chat--message--user--border: none;\n  --chat--message--pre--background: rgba(0, 0, 0, 0.05);\n  --chat--messages-list--padding: var(--chat--spacing);\n\n  /* Toggle Button */\n  --chat--toggle--size: 64px;\n  --chat--toggle--width: var(--chat--toggle--size);\n  --chat--toggle--height: var(--chat--toggle--size);\n  --chat--toggle--border-radius: 50%;\n  --chat--toggle--background: var(--chat--color--primary);\n  --chat--toggle--hover--background: var(--chat--color--primary-shade-50);\n  --chat--toggle--active--background: var(--chat--color--primary--shade-100);\n  --chat--toggle--color: var(--chat--color-white);\n\n  /* Input Area */\n  --chat--textarea--height: 50px;\n  --chat--textarea--max-height: 30rem;\n  --chat--input--font-size: inherit;\n  --chat--input--border: 0;\n  --chat--input--border-radius: 0;\n  --chat--input--padding: 0.8rem;\n  --chat--input--background: var(--chat--color-white);\n  --chat--input--text-color: initial;\n  --chat--input--line-height: 1.5;\n  --chat--input--placeholder--font-size: var(--chat--input--font-size);\n  --chat--input--border-active: 0;\n  --chat--input--left--panel--width: 2rem;\n\n  /* Button Styles */\n  --chat--button--padding: calc(var(--chat--spacing) * 5 / 8) var(--chat--spacing);\n  --chat--button--border-radius: var(--chat--border-radius);\n  --chat--button--font-size: 1rem;\n  --chat--button--line-height: 1;\n  --chat--button--color--primary: var(--chat--color-light);\n  --chat--button--background--primary: var(--chat--color--secondary);\n  --chat--button--border--primary: none;\n  --chat--button--color--primary--hover: var(--chat--color-light);\n  --chat--button--background--primary--hover: var(--chat--color-secondary-shade-50);\n  --chat--button--border--primary--hover: none;\n  --chat--button--color--primary--disabled: var(--chat--color-light);\n  --chat--button--background--primary--disabled: #81bbb1;\n  --chat--button--border--primary--disabled: none;\n  --chat--button--color--secondary: var(--chat--color-light);\n  --chat--button--background--secondary: hsl(0, 0%, 58%);\n  --chat--button--border--secondary: none;\n  --chat--button--color--secondary--hover: var(--chat--color-light);\n  --chat--button--background--secondary--hover: hsl(0, 0%, 51%);\n  --chat--button--border--secondary--hover: none;\n  --chat--button--color--secondary--disabled: var(--chat--color-light);\n  --chat--button--background--secondary--disabled: hsl(0, 0%, 78%);\n  --chat--button--border--secondary--disabled: none;\n  --chat--close--button--color-hover: var(--chat--color--primary);\n\n  /* Send and File Buttons */\n  --chat--input--send--button--background: var(--chat--color-white);\n  --chat--input--send--button--color: var(--chat--color--secondary);\n  --chat--input--send--button--background-hover: var(--chat--color--primary-shade-50);\n  --chat--input--send--button--color-hover: var(--chat--color-secondary-shade-50);\n  --chat--input--file--button--background: var(--chat--color-white);\n  --chat--input--file--button--color: var(--chat--color--secondary);\n  --chat--input--file--button--background-hover: var(--chat--input--file--button--background);\n  --chat--input--file--button--color-hover: var(--chat--color-secondary-shade-50);\n  --chat--files-spacing: 0.25rem;\n\n  /* Body and Footer */\n  --chat--body--background: var(--chat--color-light);\n  --chat--footer--background: var(--chat--color-light);\n  --chat--footer--color: var(--chat--color-dark);\n}\n\n\n/* You can override any class styles, too. Right-click inspect in Chat UI to find class to override. */\n.chat-message {\n\tmax-width: 50%;\n}",
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat"
              ]
            }
          },
          "type": "string",
          "x-rows": 10,
          "x-editor": "cssEditor"
        },
        "responseMode": {
          "x-title": "Response Mode",
          "description": "When and how to respond to the chat",
          "default": "streaming",
          "x-displayOptions": {
            "show": {
              "/mode": [
                "hostedChat"
              ],
              "/availableInChat": [
                true
              ]
            }
          },
          "type": "string",
          "enum": [
            "streaming",
            "lastNode",
            "responseNodes"
          ],
          "x-enumNames": [
            "Streaming",
            "When Last Node Finishes",
            "Using Response Nodes"
          ],
          "x-enumDescriptions": [
            "Streaming response from specified nodes (e.g. Agents)",
            "Returns data of the last-executed node",
            "Send responses to the chat by using one or more Chat nodes"
          ]
        }
      }
    }
  },
  "x-icon": "fa:comments",
  "x-inputs": "={{ (() => {\n\t\t\tif (!['hostedChat', 'webhook'].includes($parameter.mode)) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tif ($parameter.options?.loadPreviousSession !== 'memory') {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tdisplayName: 'Memory',\n\t\t\t\t\tmaxConnections: 1,\n\t\t\t\t\ttype: 'ai_memory',\n\t\t\t\t\trequired: true,\n\t\t\t\t}\n\t\t\t];\n\t\t })() }}",
  "x-outputs": [
    "main"
  ],
  "x-credentials": [
    {
      "name": "httpBasicAuth",
      "required": true,
      "displayOptions": {
        "show": {
          "authentication": [
            "basicAuth"
          ]
        }
      }
    }
  ],
  "x-webhooks": "true"
}
