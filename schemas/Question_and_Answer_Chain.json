{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Question and Answer Chain",
  "description": "Answer questions about retrieved documents",
  "x-n8n-node-type": "chainRetrievalQa",
  "x-n8n-version": [
    1,
    1.1,
    1.2,
    1.3,
    1.4,
    1.5,
    1.6,
    1.7
  ],
  "x-n8n-group": [
    "transform"
  ],
  "type": "object",
  "properties": {
    "query": {
      "x-title": "Query",
      "default": "={{ $json.chatInput }}",
      "x-displayOptions": {
        "show": {
          "@version": [
            1.2
          ]
        }
      },
      "x-required": true,
      "type": "string"
    },
    "promptType": {
      "x-title": "Source for Prompt (User Message)",
      "default": "auto",
      "x-displayOptions": {
        "show": {
          "@version": [
            {
              "_cnd": {
                "gte": 1.7
              }
            }
          ]
        }
      },
      "type": "string",
      "enum": [
        "auto",
        "define"
      ],
      "x-enumNames": [
        "Connected Chat Trigger Node",
        "Define below"
      ],
      "x-enumDescriptions": [
        "Looks for an input field called 'chatInput' that is coming from a directly connected Chat Trigger",
        "Use an expression to reference data in previous nodes or enter static text"
      ]
    },
    "text": {
      "x-title": "Prompt (User Message)",
      "default": "",
      "x-displayOptions": {
        "show": {
          "promptType": [
            "define"
          ]
        }
      },
      "x-required": true,
      "type": "string",
      "x-rows": 2
    },
    "options": {
      "x-title": "Options",
      "default": {},
      "type": "object",
      "properties": {
        "systemPromptTemplate": {
          "x-title": "System Prompt Template",
          "description": "Template string used for the system prompt. This should include the variable `{context}` for the provided context. For text completion models, you should also include the variable `{input}` for the userâ€™s query.",
          "default": "You are an assistant for question-answering tasks. Use the following pieces of retrieved context to answer the question.\nIf you don't know the answer, just say that you don't know, don't try to make up an answer.\n----------------\nContext: {context}",
          "x-displayOptions": {
            "show": {
              "@version": [
                {
                  "_cnd": {
                    "gte": 1.5
                  }
                }
              ]
            }
          },
          "type": "string",
          "x-rows": 6
        },
        "batching": {
          "x-title": "Batch Processing",
          "description": "Batch processing options for rate limiting",
          "default": {},
          "x-displayOptions": {
            "show": {
              "@version": [
                {
                  "_cnd": {
                    "gte": 1.6
                  }
                }
              ]
            }
          },
          "type": "object",
          "properties": {
            "batchSize": {
              "x-title": "Batch Size",
              "description": "How many items to process in parallel. This is useful for rate limiting, but might impact the log output ordering.",
              "default": 5,
              "type": "number"
            },
            "delayBetweenBatches": {
              "x-title": "Delay Between Batches",
              "description": "Delay in milliseconds between batches. This is useful for rate limiting.",
              "default": 0,
              "type": "number"
            }
          }
        }
      }
    }
  },
  "x-icon": "fa:link",
  "x-inputs": [
    "main",
    {
      "displayName": "Model",
      "maxConnections": 1,
      "type": "ai_languageModel",
      "required": true
    },
    {
      "displayName": "Retriever",
      "maxConnections": 1,
      "type": "ai_retriever",
      "required": true
    }
  ],
  "x-outputs": [
    "main"
  ],
  "x-credentials": []
}
