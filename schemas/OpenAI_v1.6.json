{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OpenAI",
  "description": "Message an assistant or GPT, analyze images, generate audio, etc.",
  "x-n8n-node-type": "openAi",
  "x-n8n-version": 1.6,
  "x-n8n-group": [
    "transform"
  ],
  "type": "object",
  "properties": {
    "resource": {
      "x-title": "Resource",
      "default": "text",
      "type": "string",
      "enum": [
        "assistant",
        "text",
        "image",
        "audio",
        "file"
      ],
      "x-enumNames": [
        "Assistant",
        "Text",
        "Image",
        "Audio",
        "File"
      ]
    },
    "operation": {
      "x-title": "Operation",
      "default": "message",
      "x-displayOptions": {
        "show": {
          "resource": [
            "text"
          ]
        }
      },
      "type": "string",
      "enum": [
        "message",
        "classify"
      ],
      "x-enumNames": [
        "Message a Model",
        "Classify Text for Violations"
      ],
      "x-enumDescriptions": [
        "Create a completion with GPT 3, 4, etc.",
        "Check whether content complies with usage policies"
      ]
    },
    "modelId": {
      "x-title": "Model",
      "default": {
        "mode": "list",
        "value": ""
      },
      "x-displayOptions": {
        "show": {
          "operation": [
            "message"
          ],
          "resource": [
            "text"
          ]
        }
      },
      "x-required": true,
      "type": "object",
      "properties": {
        "__rl": {
          "type": "boolean",
          "const": true
        },
        "mode": {
          "type": "string",
          "enum": [
            "list",
            "id"
          ]
        },
        "value": {
          "type": "string"
        }
      },
      "required": [
        "mode",
        "value"
      ],
      "x-modes": [
        {
          "name": "list",
          "displayName": "From List",
          "type": "list"
        },
        {
          "name": "id",
          "displayName": "ID",
          "type": "string"
        }
      ]
    },
    "name": {
      "x-title": "Name",
      "description": "The name of the assistant. The maximum length is 256 characters.",
      "default": "",
      "x-displayOptions": {
        "show": {
          "operation": [
            "create"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "x-required": true,
      "type": "string"
    },
    "description": {
      "x-title": "Description",
      "description": "The description of the assistant. The maximum length is 512 characters.",
      "default": "",
      "x-displayOptions": {
        "show": {
          "operation": [
            "create"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "type": "string"
    },
    "instructions": {
      "x-title": "Instructions",
      "description": "The system instructions that the assistant uses. The maximum length is 32768 characters.",
      "default": "",
      "x-displayOptions": {
        "show": {
          "operation": [
            "create"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "type": "string",
      "x-rows": 2
    },
    "codeInterpreter": {
      "x-title": "Code Interpreter",
      "description": "Whether to enable the code interpreter that allows the assistants to write and run Python code in a sandboxed execution environment, find more <a href=\"https://platform.openai.com/docs/assistants/tools/code-interpreter\" target=\"_blank\">here</a>",
      "default": false,
      "x-displayOptions": {
        "show": {
          "operation": [
            "create"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "type": "boolean"
    },
    "knowledgeRetrieval": {
      "x-title": "Knowledge Retrieval",
      "description": "Whether to augments the assistant with knowledge from outside its model, such as proprietary product information or documents, find more <a href=\"https://platform.openai.com/docs/assistants/tools/knowledge-retrieval\" target=\"_blank\">here</a>",
      "default": false,
      "x-displayOptions": {
        "show": {
          "operation": [
            "create"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "type": "boolean"
    },
    "file_ids": {
      "x-title": "Files",
      "description": "The files to be used by the assistant, there can be a maximum of 20 files attached to the assistant",
      "default": [],
      "x-displayOptions": {
        "show": {
          "knowledgeRetrieval": [
            true
          ],
          "codeInterpreter": [
            true
          ],
          "operation": [
            "create"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "options": {
      "x-title": "Options",
      "default": {},
      "x-displayOptions": {
        "show": {
          "operation": [
            "message"
          ],
          "resource": [
            "text"
          ]
        }
      },
      "type": "object",
      "properties": {
        "frequency_penalty": {
          "x-title": "Frequency Penalty",
          "description": "Positive values penalize new tokens based on their existing frequency in the text so far, decreasing the model's likelihood to repeat the same line verbatim",
          "default": 0,
          "type": "number",
          "minimum": -2,
          "maximum": 2,
          "x-precision": 1
        },
        "maxTokens": {
          "x-title": "Maximum Number of Tokens",
          "description": "The maximum number of tokens to generate in the completion. Most models have a context length of 2048 tokens (except for the newest models, which support 32,768).",
          "default": 16,
          "type": "number",
          "maximum": 32768
        },
        "n": {
          "x-title": "Number of Completions",
          "description": "How many completions to generate for each prompt. Note: Because this parameter generates many completions, it can quickly consume your token quota. Use carefully and ensure that you have reasonable settings for max_tokens and stop.",
          "default": 1,
          "type": "number"
        },
        "presence_penalty": {
          "x-title": "Presence Penalty",
          "description": "Positive values penalize new tokens based on whether they appear in the text so far, increasing the model's likelihood to talk about new topics",
          "default": 0,
          "type": "number",
          "minimum": -2,
          "maximum": 2,
          "x-precision": 1
        },
        "temperature": {
          "x-title": "Output Randomness (Temperature)",
          "description": "Controls randomness: Lowering results in less random completions. As the temperature approaches zero, the model will become deterministic and repetitive. We generally recommend altering this or temperature but not both.",
          "default": 1,
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "x-precision": 1
        },
        "topP": {
          "x-title": "Output Randomness (Top P)",
          "description": "An alternative to sampling with temperature, controls diversity via nucleus sampling: 0.5 means half of all likelihood-weighted options are considered. We generally recommend altering this or temperature but not both.",
          "default": 1,
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "x-precision": 1
        },
        "reasoning_effort": {
          "x-title": "Reasoning Effort",
          "description": "Controls the amount of reasoning tokens to use. A value of \"low\" will favor speed and economical token usage, \"high\" will favor more complete reasoning at the cost of more tokens generated and slower responses.",
          "default": "medium",
          "x-displayOptions": {
            "show": {
              "/modelId": [
                {
                  "_cnd": {
                    "regex": "(^o1([-\\d]+)?$)|(^o[3-9].*)|(^gpt-5.*)"
                  }
                }
              ]
            }
          },
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high"
          ],
          "x-enumNames": [
            "Low",
            "Medium",
            "High"
          ],
          "x-enumDescriptions": [
            "Favors speed and economical token usage",
            "Balance between speed and reasoning accuracy",
            "Favors more complete reasoning at the cost of more tokens generated and slower responses"
          ]
        },
        "maxToolsIterations": {
          "x-title": "Max Tool Calls Iterations",
          "description": "The maximum number of tool iteration cycles the LLM will run before stopping. A single iteration can contain multiple tool calls. Set to 0 for no limit.",
          "default": 15,
          "x-displayOptions": {
            "show": {
              "@version": [
                {
                  "_cnd": {
                    "gte": 1.5
                  }
                }
              ]
            }
          },
          "type": "number"
        }
      }
    },
    "assistantId": {
      "x-title": "Assistant",
      "description": "Assistant to respond to the message. You can add, modify or remove assistants in the <a href=\"https://platform.openai.com/playground?mode=assistant\" target=\"_blank\">playground</a>.",
      "default": {
        "mode": "list",
        "value": ""
      },
      "x-displayOptions": {
        "show": {
          "operation": [
            "update"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "x-required": true,
      "type": "object",
      "properties": {
        "__rl": {
          "type": "boolean",
          "const": true
        },
        "mode": {
          "type": "string",
          "enum": [
            "list",
            "id"
          ]
        },
        "value": {
          "type": "string"
        }
      },
      "required": [
        "mode",
        "value"
      ],
      "x-modes": [
        {
          "name": "list",
          "displayName": "From List",
          "type": "list"
        },
        {
          "name": "id",
          "displayName": "ID",
          "type": "string"
        }
      ]
    },
    "prompt": {
      "x-title": "Prompt",
      "description": "A text description of the desired image(s). The maximum length is 1000 characters for dall-e-2 and 4000 characters for dall-e-3.",
      "default": "",
      "x-displayOptions": {
        "show": {
          "operation": [
            "generate"
          ],
          "resource": [
            "image"
          ]
        }
      },
      "type": "string",
      "x-rows": 2
    },
    "text": {
      "x-title": "Text Input",
      "default": "What's in this image?",
      "x-displayOptions": {
        "show": {
          "operation": [
            "analyze"
          ],
          "resource": [
            "image"
          ]
        }
      },
      "type": "string",
      "x-rows": 2
    },
    "memory": {
      "x-title": "Memory",
      "default": "connector",
      "x-displayOptions": {
        "show": {
          "@version": [
            {
              "_cnd": {
                "gte": 1.6
              }
            }
          ],
          "operation": [
            "message"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "type": "string",
      "enum": [
        "connector",
        "threadId"
      ],
      "x-enumNames": [
        "Use memory connector",
        "Use thread ID"
      ],
      "x-enumDescriptions": [
        "Connect one of the supported memory nodes",
        "Specify the ID of the thread to continue"
      ]
    },
    "threadId": {
      "x-title": "Thread ID",
      "description": "The ID of the thread to continue, a new thread will be created if not specified",
      "default": "",
      "x-displayOptions": {
        "show": {
          "@version": [
            {
              "_cnd": {
                "gte": 1.6
              }
            }
          ],
          "memory": [
            "threadId"
          ],
          "operation": [
            "message"
          ],
          "resource": [
            "assistant"
          ]
        }
      },
      "type": "string"
    },
    "simplify": {
      "x-title": "Simplify Output",
      "description": "Whether to return a simplified version of the response instead of the raw data",
      "default": true,
      "x-displayOptions": {
        "show": {
          "operation": [
            "message"
          ],
          "resource": [
            "text"
          ]
        }
      },
      "type": "boolean"
    },
    "model": {
      "x-title": "Model",
      "description": "The model to use for image generation",
      "default": "dall-e-3",
      "x-displayOptions": {
        "show": {
          "operation": [
            "generate"
          ],
          "resource": [
            "image"
          ]
        }
      },
      "type": "string",
      "enum": [
        "dall-e-2",
        "dall-e-3",
        "gpt-image-1"
      ],
      "x-enumNames": [
        "DALL·E 2",
        "DALL·E 3",
        "GPT Image 1"
      ]
    },
    "input": {
      "x-title": "Text Input",
      "description": "The input text to classify if it is violates the moderation policy",
      "default": "",
      "x-displayOptions": {
        "show": {
          "operation": [
            "classify"
          ],
          "resource": [
            "text"
          ]
        }
      },
      "type": "string",
      "x-rows": 2
    },
    "voice": {
      "x-title": "Voice",
      "description": "The voice to use when generating the audio",
      "default": "alloy",
      "x-displayOptions": {
        "show": {
          "operation": [
            "generate"
          ],
          "resource": [
            "audio"
          ]
        }
      },
      "type": "string",
      "enum": [
        "alloy",
        "echo",
        "fable",
        "nova",
        "onyx",
        "shimmer"
      ],
      "x-enumNames": [
        "Alloy",
        "Echo",
        "Fable",
        "Nova",
        "Onyx",
        "Shimmer"
      ]
    },
    "binaryPropertyName": {
      "x-title": "Input Data Field Name",
      "description": "Name of the binary property which contains the image(s)",
      "default": "data",
      "x-displayOptions": {
        "show": {
          "inputType": [
            "base64"
          ],
          "operation": [
            "analyze"
          ],
          "resource": [
            "image"
          ]
        }
      },
      "type": "string"
    },
    "fileId": {
      "x-title": "File",
      "default": {
        "mode": "list",
        "value": ""
      },
      "x-displayOptions": {
        "show": {
          "operation": [
            "deleteFile"
          ],
          "resource": [
            "file"
          ]
        }
      },
      "x-required": true,
      "type": "object",
      "properties": {
        "__rl": {
          "type": "boolean",
          "const": true
        },
        "mode": {
          "type": "string",
          "enum": [
            "list",
            "id"
          ]
        },
        "value": {
          "type": "string"
        }
      },
      "required": [
        "mode",
        "value"
      ],
      "x-modes": [
        {
          "name": "list",
          "displayName": "From List",
          "type": "list"
        },
        {
          "name": "id",
          "displayName": "ID",
          "type": "string"
        }
      ]
    },
    "inputType": {
      "x-title": "Input Type",
      "default": "url",
      "x-displayOptions": {
        "show": {
          "operation": [
            "analyze"
          ],
          "resource": [
            "image"
          ]
        }
      },
      "type": "string",
      "enum": [
        "url",
        "base64"
      ],
      "x-enumNames": [
        "Image URL(s)",
        "Binary File(s)"
      ]
    },
    "imageUrls": {
      "x-title": "URL(s)",
      "description": "URL(s) of the image(s) to analyze, multiple URLs can be added separated by comma",
      "default": "",
      "x-displayOptions": {
        "show": {
          "inputType": [
            "url"
          ],
          "operation": [
            "analyze"
          ],
          "resource": [
            "image"
          ]
        }
      },
      "type": "string"
    },
    "messages": {
      "x-title": "Messages",
      "default": {
        "values": [
          {
            "content": ""
          }
        ]
      },
      "x-displayOptions": {
        "show": {
          "operation": [
            "message"
          ],
          "resource": [
            "text"
          ]
        }
      },
      "type": "object",
      "properties": {
        "values": {
          "x-title": "Values",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "content": {
                "x-title": "Prompt",
                "description": "The content of the message to be send",
                "default": "",
                "type": "string",
                "x-rows": 2
              },
              "role": {
                "x-title": "Role",
                "description": "Role in shaping the model's response, it tells the model how it should behave and interact with the user",
                "default": "user",
                "type": "string",
                "enum": [
                  "user",
                  "assistant",
                  "system"
                ],
                "x-enumNames": [
                  "User",
                  "Assistant",
                  "System"
                ],
                "x-enumDescriptions": [
                  "Send a message as a user and get a response from the model",
                  "Tell the model to adopt a specific tone or personality",
                  "Usually used to set the model's behavior or context for the next user message"
                ]
              }
            }
          }
        }
      }
    },
    "jsonOutput": {
      "x-title": "Output Content as JSON",
      "description": "Whether to attempt to return the response in JSON format. Compatible with GPT-4 Turbo and all GPT-3.5 Turbo models newer than gpt-3.5-turbo-1106.",
      "default": false,
      "x-displayOptions": {
        "show": {
          "operation": [
            "message"
          ],
          "resource": [
            "text"
          ]
        }
      },
      "type": "boolean"
    },
    "hideTools": {
      "x-title": "Hide Tools",
      "default": "hide",
      "x-displayOptions": {
        "show": {
          "modelId": [
            "gpt-3.5-turbo-16k-0613",
            "dall-e-3",
            "text-embedding-3-large",
            "dall-e-2",
            "whisper-1",
            "tts-1-hd-1106",
            "tts-1-hd",
            "gpt-4-0314",
            "text-embedding-3-small",
            "gpt-4-32k-0314",
            "gpt-3.5-turbo-0301",
            "gpt-4-vision-preview",
            "gpt-3.5-turbo-16k",
            "gpt-3.5-turbo-instruct-0914",
            "tts-1",
            "davinci-002",
            "gpt-3.5-turbo-instruct",
            "babbage-002",
            "tts-1-1106",
            "text-embedding-ada-002"
          ],
          "@version": [
            {
              "_cnd": {
                "gte": 1.2
              }
            }
          ],
          "operation": [
            "message"
          ],
          "resource": [
            "text"
          ]
        }
      },
      "type": "string"
    }
  },
  "x-subtitle": "={{((resource, operation) => {\n    if (operation === 'deleteAssistant') {\n        return 'Delete Assistant';\n    }\n    if (operation === 'deleteFile') {\n        return 'Delete File';\n    }\n    if (operation === 'classify') {\n        return 'Classify Text';\n    }\n    if (operation === 'message' && resource === 'text') {\n        return 'Message Model';\n    }\n    const capitalize = (str) => {\n        const chars = str.split('');\n        chars[0] = chars[0].toUpperCase();\n        return chars.join('');\n    };\n    if (['transcribe', 'translate'].includes(operation)) {\n        resource = 'recording';\n    }\n    if (operation === 'list') {\n        resource = resource + 's';\n    }\n    return `${capitalize(operation)} ${capitalize(resource)}`;\n})($parameter.resource, $parameter.operation)}}",
  "x-icon": {
    "light": "file:openAi.svg",
    "dark": "file:openAi.dark.svg"
  },
  "x-inputs": "={{((resource, operation, hideTools, memory) => {\n    if (resource === 'assistant' && operation === 'message') {\n        const inputs = [\n            { type: 'main' },\n            { type: 'ai_tool', displayName: 'Tools' },\n        ];\n        if (memory !== 'threadId') {\n            inputs.push({ type: 'ai_memory', displayName: 'Memory', maxConnections: 1 });\n        }\n        return inputs;\n    }\n    if (resource === 'text' && (operation === 'message' || operation === 'response')) {\n        if (hideTools === 'hide') {\n            return ['main'];\n        }\n        return [{ type: 'main' }, { type: 'ai_tool', displayName: 'Tools' }];\n    }\n    return ['main'];\n})($parameter.resource, $parameter.operation, $parameter.hideTools, $parameter.memory ?? undefined)}}",
  "x-outputs": [
    "main"
  ],
  "x-credentials": [
    {
      "name": "openAiApi",
      "required": true
    }
  ]
}
